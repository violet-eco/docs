<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>LapisOS documentation</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Documents for LapisOS">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="FOREWORD.html"><strong aria-hidden="true">1.</strong> Foreword</a></li><li class="chapter-item expanded "><a href="FAQ.html"><strong aria-hidden="true">2.</strong> Frequently-asked Questions</a></li><li class="chapter-item expanded "><a href="project/index.html"><strong aria-hidden="true">3.</strong> Project</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="project/roadmap.html"><strong aria-hidden="true">3.1.</strong> Roadmap</a></li><li class="chapter-item expanded "><a href="project/development.html"><strong aria-hidden="true">3.2.</strong> Development</a></li></ol></li><li class="chapter-item expanded "><a href="concepts/index.html"><strong aria-hidden="true">4.</strong> Concepts</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="concepts/applications.html"><strong aria-hidden="true">4.1.</strong> What are applications?</a></li><li class="chapter-item expanded "><a href="concepts/libraries.html"><strong aria-hidden="true">4.2.</strong> What are libraries?</a></li><li class="chapter-item expanded "><a href="concepts/users.html"><strong aria-hidden="true">4.3.</strong> What are users?</a></li></ol></li><li class="chapter-item expanded "><a href="features/index.html"><strong aria-hidden="true">5.</strong> Features</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="features/parental-control.html"><strong aria-hidden="true">5.1.</strong> Parental Control</a></li></ol></li><li class="chapter-item expanded "><a href="ux/index.html"><strong aria-hidden="true">6.</strong> User Experience</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ux/notifications.html"><strong aria-hidden="true">6.1.</strong> Notifications</a></li></ol></li><li class="chapter-item expanded "><a href="technical/index.html"><strong aria-hidden="true">7.</strong> Technical</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="technical/overview.html"><strong aria-hidden="true">7.1.</strong> Overview</a></li><li class="chapter-item expanded "><a href="technical/controller.html"><strong aria-hidden="true">7.2.</strong> Controller</a></li><li class="chapter-item expanded "><a href="technical/dev-mode.html"><strong aria-hidden="true">7.3.</strong> Developer Mode</a></li><li class="chapter-item expanded "><a href="technical/devices.html"><strong aria-hidden="true">7.4.</strong> Devices</a></li></ol></li><li class="chapter-item expanded "><a href="specs/index.html"><strong aria-hidden="true">8.</strong> Specifications</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="specs/applications-and-libraries.html"><strong aria-hidden="true">8.1.</strong> Applications and libraries</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">LapisOS documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/lapis-org/docs" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="foreword"><a class="header" href="#foreword">Foreword</a></h1>
<h2 id="welcome"><a class="header" href="#welcome">Welcome!</a></h2>
<p>Welcome to LapisOS' documentation! This book will show you how the
system is designed, how it works, and all the little things it can offer
to the end user as well as the features available for application developers.</p>
<p><strong>Before reading this documentation, please note that</strong> I'm developing this
project on my own and I'm by no mean an operating system expert.</p>
<p>This means there are surely many flaws in the very low-level aspects, especially
in the microkernel, like the way hardware devices are handled and mapped in memory.
If you find a flaw, feel free to <a href="https://github.com/lapis-org/docs/issues/new/choose">submit an issue</a>.</p>
<h3 id="what-is-lapisos"><a class="header" href="#what-is-lapisos">What is LapisOS?</a></h3>
<p>LapisOS is an operating system aiming to replace ancient systems like Windows,
Linux, MacOS. Well, this is an <em>ideal</em> goal but given how much Windows/Linux/MacOS
and other systems are deeply installed in today's computers, LapisOS is more of
a theorical operating system that shows what we could get if we hadn't to maintain
legacy compatibility with ancient architectures.</p>
<h3 id="whats-the-projects-structure"><a class="header" href="#whats-the-projects-structure">What's the project's structure?</a></h3>
<p>The project is composed of three distinct parts: the kernel, the system
and the desktop environment.</p>
<p>The first one is the part that allows the software to access the hardware,
like writing files to the disk. It's a microkernel, meaning it's easier to
maintain and has a reduced attack surface for potential security issues
than a monolithic kernel like Linux.</p>
<p>The system is the higher-level component that deals with everything that is
not directly related to hardware or graphical interface. For instance, applications,
user accounts and permissions are all managed by the system.</p>
<p>The desktop environment, finally, is the part the user sees when launching LapisOS.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="frequently-asked-questions"><a class="header" href="#frequently-asked-questions">Frequently-asked Questions</a></h1>
<ul>
<li><a href="will-this-project-replace-windowsmacoslinux-one-day">Will this project replace Windows/MacOS/Linux/... one day?</a></li>
<li><a href="FAQ.html#how-can-i-help">How can I help?</a></li>
</ul>
<h2 id="will-this-project-replace-windowsmacoslinux-one-day"><a class="header" href="#will-this-project-replace-windowsmacoslinux-one-day">Will this project replace Windows/MacOS/Linux/... one day?</a></h2>
<p>No. Absolutely not. Because, it's not viable for an operating system
today to just get rid of all backward compatibility with existing software,
simply because what users are interested in applications first, and <strong>then</strong>
the system itself - it's secure, stable, performant, and so on.</p>
<p>Imagine someone introducing the perfect operating system, but with almost
no application on it. Would you get rid of your Windows/MacOS/Linux/... system
for this one? Surely not, at least not as your everyday system.</p>
<p>This is why this project is for now purely <em>theorical</em>.</p>
<h2 id="how-can-i-help"><a class="header" href="#how-can-i-help">How can I help?</a></h2>
<p>Help is very welcome but there's not many things to help with currently,
as the system is still being designed. You can still help by suggesting
improvements or fixing an error (whatever it is, a design problem or a simple typo)
by <a href="https://github.com/lapis-org/docs/issues/new/choose">submitting an issue</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="project"><a class="header" href="#project">Project</a></h1>
<p>This folder contains the documentation about the project itself.</p>
<ul>
<li><a href="project/roadmap.html">Roadmap</a> - the project's roadmap</li>
<li><a href="project/development.html">Development</a> - how the project will be developed</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="roadmap"><a class="header" href="#roadmap">Roadmap</a></h1>
<ul>
<li><a href="project/roadmap.html#roadmap">Roadmap</a>
<ul>
<li><a href="project/roadmap.html#conception">Conception</a></li>
<li><a href="project/roadmap.html#validation">Validation</a></li>
<li><a href="project/roadmap.html#implementation">Implementation</a>
<ul>
<li><a href="project/roadmap.html#phase-1-unoptimized-kernel">Phase 1: Unoptimized kernel</a></li>
<li><a href="project/roadmap.html#phase-2-low-level-implementation">Phase 2: Low-level implementation</a></li>
<li><a href="project/roadmap.html#phase-3-applications--system-optimization">Phase 3: Applications &amp; System Optimization</a></li>
<li><a href="project/roadmap.html#phase-4-completion">Phase 4: Completion</a></li>
</ul>
</li>
<li><a href="project/roadmap.html#evolution-optimization--maintenance">Evolution, Optimization &amp; Maintenance</a></li>
</ul>
</li>
</ul>
<h2 id="conception"><a class="header" href="#conception">Conception</a></h2>
<p>This first part is to write conception documents about how the system works, both at
high-level (native applications, features etc.) and low-level (process management, kernel
design etc.).</p>
<p>This project is currently in this state.</p>
<h2 id="validation"><a class="header" href="#validation">Validation</a></h2>
<p>Once all conception documents are ready, they will be validated one by one,
and frozen. Breaking changes after validation are still possible but should
be avoided as much as possible.</p>
<h2 id="implementation"><a class="header" href="#implementation">Implementation</a></h2>
<p>Once all documents have been validated, the different pieces can be implemented.</p>
<p>It may be happen that, during implementation, some validated documents get
modifications in order to improve or fix some specific points. Each modification
will need to be validated in order to preserve the stability of these documents.</p>
<h3 id="phase-1-unoptimized-kernel"><a class="header" href="#phase-1-unoptimized-kernel">Phase 1: Unoptimized kernel</a></h3>
<p>The first piece to be implemented will be the kernel. This is required as the
kernel is needed in order to implement higher-level pieces like processes.</p>
<h3 id="phase-2-low-level-implementation"><a class="header" href="#phase-2-low-level-implementation">Phase 2: Low-level implementation</a></h3>
<p>Once the unoptimized kernel is ready, two implementations will start in parallel:</p>
<ul>
<li>Kernel optimization</li>
<li>System development</li>
</ul>
<p>The system development will consist in building the following pieces successively:</p>
<ul>
<li>The BIOS/UEFI bootloader</li>
<li>The process manager</li>
</ul>
<h3 id="phase-3-applications--system-optimization"><a class="header" href="#phase-3-applications--system-optimization">Phase 3: Applications &amp; System Optimization</a></h3>
<p>The third phase consists in developing the native applications, which are
meant to be used by the end user, as well as optimizing the system in
parallel and improving its stability.</p>
<p>Starting from this point, all conception documents are definitely validated,
which means they cannot receive breaking changes anymore, only few points/features.</p>
<p>This also coincides with the system's <strong>first alpha release</strong>, which will allow persons
who are external to the project to test it and suggest improvements.</p>
<h3 id="phase-4-completion"><a class="header" href="#phase-4-completion">Phase 4: Completion</a></h3>
<p>The last phase's purpose is to ensure the system is in a fully usable state.</p>
<p>The kernel and system will also need to be properly optimized, and once all
these things are done a <strong>first beta release</strong> will be deployed.</p>
<h2 id="evolution-optimization--maintenance"><a class="header" href="#evolution-optimization--maintenance">Evolution, Optimization &amp; Maintenance</a></h2>
<p>The <em>Evolution, Optimization &amp; Maintenance</em> (EPM) part is pretty explicit: it's all
about improving LapisOS' existing features, introducing new ones as needed, improving
performances and stability, and fixing new bugs.</p>
<p>This part will last forever, as for all operating systems.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="development"><a class="header" href="#development">Development</a></h1>
<ul>
<li><a href="project/development.html#development">Development</a>
<ul>
<li><a href="project/development.html#languages">Languages</a></li>
</ul>
</li>
</ul>
<h2 id="languages"><a class="header" href="#languages">Languages</a></h2>
<p>The project will be developed in C, with first-class support for this language.</p>
<p>Usage of architecture-specific Assembly will be reduced as much as possible, being
only used in two cases:</p>
<ul>
<li>The desired behaviour cannot be reached without Assembly
(e.g. direct register or stack manipulation)</li>
<li>Extremely performance-critical pieces</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="concepts"><a class="header" href="#concepts">Concepts</a></h1>
<p>This folder contains documentations for each high-level
concept of LapisOS. They are designed to be easily readable
and understandable.</p>
<ul>
<li><a href="concepts/applications.html">What are applications?</a> - the way to run software on LapisOS</li>
<li><a href="concepts/libraries.html">What are libraries?</a> - sharing identical behaviours between multiple applications</li>
<li><a href="concepts/users.html">What are users?</a> - sharing a computer between multiple persons</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="what-are-applications"><a class="header" href="#what-are-applications">What are applications?</a></h1>
<p><em>Applications</em> are the system's way to handle software.</p>
<ul>
<li><a href="concepts/applications.html#what-are-applications">What are applications?</a>
<ul>
<li><a href="concepts/applications.html#how-applications-work">How applications work</a></li>
<li><a href="concepts/applications.html#installation-methods">Installation methods</a>
<ul>
<li><a href="concepts/applications.html#from-the-store">From the store</a></li>
<li><a href="concepts/applications.html#sideloading">Sideloading</a></li>
<li><a href="concepts/applications.html#volatile-applications">Volatile applications</a></li>
</ul>
</li>
<li><a href="concepts/applications.html#commands">Commands</a></li>
<li><a href="concepts/applications.html#system-applications">System applications</a></li>
<li><a href="concepts/applications.html#services">Services</a></li>
</ul>
</li>
</ul>
<h2 id="how-applications-work"><a class="header" href="#how-applications-work">How applications work</a></h2>
<p>An application is a set of executable files and resources. They are
only way to execute code, as direct binary programs are not supported.</p>
<p>Any user can install applications, which will only be available from its
account. Administrator users can install global applications, which are
available to every user.</p>
<h2 id="installation-methods"><a class="header" href="#installation-methods">Installation methods</a></h2>
<p>Applications are installed through an <em>application package</em>. There
are several installation methods:</p>
<ul>
<li>From the store</li>
<li>Directly from the application's package</li>
<li>As a volatile application</li>
</ul>
<h3 id="from-the-store"><a class="header" href="#from-the-store">From the store</a></h3>
<p>Applications can be downloaded from LapisOS' official applications store.</p>
<ul>
<li>For closed-source applications, the store only provides pre-compiled programs</li>
<li>For open-source applications, the store provides both pre-compiled programs as well
as the source code</li>
</ul>
<p>For the later, user can choose either to build the program from source, using the
appropriated build tools in order to optimize performances, or to simply use the
pre-built programs (which is the option by default).</p>
<h3 id="sideloading"><a class="header" href="#sideloading">Sideloading</a></h3>
<p>Applications sideloading (installing an application directly from its <a href="concepts/">package (WIP)</a>)
follows strict rules determined by the <em>sideloading mode</em>, which is either
&quot;disabled&quot;, &quot;secure&quot; or &quot;unsecure&quot;.</p>
<ul>
<li><strong>Disable mode</strong> prevents all sideloading; it's not possible to install
applications from their package in this mode. <a href="concepts/applications.html#volatile-applications">Volatile applications</a>
can still be run, though.</li>
<li><strong>Secure mode</strong> allows sideloading but will first make the system check
if the application's <a href="concepts/">AID (WIP)</a> matches an existing application on the Store.
If so, it compares the application's signature to the Store application's
store. If they don't match, the application is considered malicious and
won't be installed. Note that this mode only works while connected to 
internet, as the system needs to check the Store to ensure the application
is not malicious. If the computer is offline, sideloading will be
disabled.</li>
<li><strong>Unsecure mode</strong> allows sideloading without any checking, which is
highly dangerous as it allows spoofing.</li>
</ul>
<p>The sideloading mode can be changed in the <a href="concepts/">Control Center (WIP)</a>.</p>
<h3 id="volatile-applications"><a class="header" href="#volatile-applications">Volatile applications</a></h3>
<p>Applications can be also be ran as <em>volatile applications</em>, which means
they are not installed on the disk. There are three methods:</p>
<ul>
<li><em>Full-volatile</em>: the app's datas are removed when the application closes</li>
<li><em>Session-scoped</em>: the app's datas are stored on disk until the system shuts down</li>
<li><em>Local-persistent</em>: the app's datas are stored within a data file located in the same folder</li>
<li><em>Persistent</em>: the app's datas are stored in a dedicated folder, also enabling common data between users</li>
</ul>
<p>By default, volatile applications are ran in <em>local-persistent</em> mode. In this mode,
the system first checks if a file with the same name as application's package but with
the <em>.vad (Volatile Application's Data)</em> exists. If so, it opens this file as the application's
storage. Then, when the application wants to store some data, it is stored inside in this data file.</p>
<p>Note that <em>.vad (Volatile Application's Data)</em> files are disguised <a href="concepts/">VSF (WIP)</a> files.</p>
<p>Volatile applications running as persistent do not appear in the applications list
and can only be managed through a specific option in the <a href="concepts/">Control Center (WIP)</a>.
Their executable files are not stored anywhere and stay in the application's package,
while only their data are stored on the disk. This allows to run the same application
several times without losing any data and without worrying about a data file. This
also allows to store a common data between users.</p>
<p>Note that the store has an option for installing applications as volatile.</p>
<h2 id="commands"><a class="header" href="#commands">Commands</a></h2>
<p>Applications can expose <a href="concepts/">shell commands (WIP)</a>. Multiple commands can be exposed
without any risk of clashing as the name command name must be prefixed by the
AID first.</p>
<p>For instance, if an application with AID <code>developer.app</code> exposes an <code>get_time</code> command,
the final usable command will be <code>developer.app.get_time</code>.</p>
<p>This is quite long name but allows to prevent any clashing between commands. It's
common for shell scripts to use imports at the beginning of the script to refer
more easily to applications' commands.</p>
<p>Note that, by default, shell prompts (not scripts) will allow to directly use
commands such as <code>get_time</code> in the short form if no other application exposes a
command with the same name.</p>
<p>Commands work by launching the application with specific <a href="concepts/">execution context (WIP)</a>.</p>
<h2 id="system-applications"><a class="header" href="#system-applications">System applications</a></h2>
<p>Some [native applications (WIP)] are part of the system itself and are called
<em>system applications</em>. They get a few specific features:</p>
<ul>
<li>Access to system-reserved features</li>
<li>Ability to create <a href="concepts/">system services (WIP)</a></li>
<li>They cannot be uninstalled</li>
</ul>
<p>System applications cannot be removed in <em>any way</em>, as some of them are critical
for the system to function properly. Native applications which are not system
applications can be removed, though.</p>
<h2 id="services"><a class="header" href="#services">Services</a></h2>
<p>Applications can provide <a href="concepts/">services (WIP)</a> by specifying them in their <a href="concepts/">manifest (WIP)</a>.
The services will be run at startup with the usual application's permissions.</p>
<p>There is exactly one process for each service per active user.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="what-are-libraries"><a class="header" href="#what-are-libraries">What are libraries?</a></h1>
<p><em>Libraries</em> allow to share a program between multiple applications.</p>
<h2 id="how-libraries-work"><a class="header" href="#how-libraries-work">How libraries work?</a></h2>
<p>Unlike applications, libraries can be installed in multiple versions.
This means you can have three versions of the same library installed
at the same time on your computer.</p>
<p>When an application wants to use a library, it explicitly indicates
the list of versions it is compatible with. The system gets the
related version and provides it to the application.</p>
<p>A library by itself cannot do itself; no background process, no
commands exposure, no permission granting. Applications simply
use libraries as helpers to achieve specific tasks.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="what-are-users"><a class="header" href="#what-are-users">What are users?</a></h1>
<ul>
<li><a href="concepts/users.html#what-are-users">What are users?</a>
<ul>
<li><a href="concepts/users.html#the-concept">The concept</a></li>
<li><a href="concepts/users.html#users-type">Users type</a></li>
<li><a href="concepts/users.html#dangers-of-an-administrator-account">Dangers of an administrator account</a></li>
<li><a href="concepts/users.html#user-privileges-elevation-upe">User Privileges Elevation (UPE)</a></li>
<li><a href="concepts/users.html#groups">Groups</a></li>
</ul>
</li>
</ul>
<h2 id="the-concept"><a class="header" href="#the-concept">The concept</a></h2>
<p>Many computers are intended to be shared by multiple persons.
In such case, it is useful to separate the data of each user
and to prevent other users from accessing another's.</p>
<p>By default, there is two user accounts: the System and the Administrator.
They are called <em>virtual users</em> because it's not possible to log in
these accounts. Other users are called <em>custom users</em>.</p>
<p>Each custom user has a dedicated data directory called <em>homedir</em>, in
<code>/home/[username]</code>, as well as a list of files and directories it
can read and/or write. By default, each user gets access to:</p>
<ul>
<li>Its homedir in <code>/home/[username]</code></li>
<li>The mounted periphericals in <code>/media</code></li>
<li>Its temporary directory in <code>/tmp/[username]</code></li>
</ul>
<h2 id="users-type"><a class="header" href="#users-type">Users type</a></h2>
<p>Each user is of a specific type:</p>
<ul>
<li><em>Phantom</em>: the user's datas are erased after the computer is turned off</li>
<li><em>Standard</em>: nothing special</li>
<li><em>Administrator</em>: can run programs directly as administrator</li>
<li><em>Main administrator</em>: administrator that can manage storage encryption</li>
</ul>
<p>When a user wants to perform a task it does not have the privileges to,
it can (by default) ask to run the task as <em>another user</em>. The other user's
credentials are then required.</p>
<p>It's not possible to ask to run a task as system or as administrator as these
accounts are virtual and do not have passwords such, <strong>except</strong> if an administrator
user tries to run a task as administrator.</p>
<p>Note that there is always one and exactly one main administrator. The user account
is created during the installation process, and can be transferred later on to
another administrator account.</p>
<h2 id="dangers-of-an-administrator-account"><a class="header" href="#dangers-of-an-administrator-account">Dangers of an administrator account</a></h2>
<p>The problem with administrators account is that <strong>can do almost anything</strong>
(except some very specific things like editing the system's files). They can
change system settings, read and change other users' data, and even run background
processes at startup. They also have all possible privileges as they can edit their
own.</p>
<p>This is why it's extremely discouraged to have two administrator users on the
same computer, unless the two accounts are used by really trustworthy persons.
As such, a large warning is shown if you try to create a new administrator user.</p>
<h2 id="user-privileges-elevation-upe"><a class="header" href="#user-privileges-elevation-upe">User Privileges Elevation (UPE)</a></h2>
<p>Users can ask to perform a task with the privileges of another user, such
as running a program as administrator. This uses the <em>User Privileges Elevation</em>
(UPE) system.</p>
<p>In such case, the program is still run as the current user, but with the
privileges of both the running user and the user specified to the UPE.</p>
<p>Running a program with UPE requires to know either the other account's
password, or to have an <em>authorization</em> from this user. For instance, admin.
users have an <em>authorization</em> to use Administrator account, without providing
any password, although a human confirmation is required.</p>
<p>Each request, successful or not, is logged in the log file at <code>/etc/logs/auc</code>.</p>
<h2 id="groups"><a class="header" href="#groups">Groups</a></h2>
<p><em>Groups</em> are a set of privileges defined by the administrator. Access some folders
or application's permissions (e.g. microphone access) can be restricted to a specific
group, for instance. When a user is created, it can be put in a group. It then
automatically inherits all of the group's privileges, in addition to its own ones.
The administrator can add and remove users from groups with the control panel.</p>
<p>When a user is in a group, the group's privileges cannot be revoked for this user.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="features"><a class="header" href="#features">Features</a></h1>
<p>This folder contains explanations about each major feature of LapisOS.
Each document is designed to be easy to read and understand.</p>
<ul>
<li><a href="features/parental-control.html">Parental Control</a> - manage children access to the computer</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="parental-control"><a class="header" href="#parental-control">Parental Control</a></h1>
<p><em>Parental control</em> allows to manage a child's access to
a computer running LapisOS.</p>
<ul>
<li><a href="features/parental-control.html#parental-control">Parental Control</a>
<ul>
<li><a href="features/parental-control.html#how-it-works">How it works</a></li>
<li><a href="features/parental-control.html#features">Features</a>
<ul>
<li><a href="features/parental-control.html#restrict-usage-hours">Restrict usage hours</a></li>
<li><a href="features/parental-control.html#restrict-mature-contents">Restrict mature contents</a></li>
<li><a href="features/parental-control.html#restrict-access-to-applications">Restrict access to applications</a></li>
<li><a href="features/parental-control.html#restrict-access-to-websites">Restrict access to websites</a></li>
<li><a href="features/parental-control.html#restrict-installation-of-applications">Restrict installation of applications</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="how-it-works"><a class="header" href="#how-it-works">How it works</a></h2>
<p>Parental control works using (at least) two accounts: the parent's
account, and the child's account, which is related to as a <em>child user</em>.
Note that multiple child users can be managed using parental control.</p>
<p>The parent account then gets access to an application called &quot;Parental Control&quot;,
which allows access all parental control-related features for each child user.</p>
<p>It is also possible to get important notifications by email, and even to install
a smartphone application (iOS/Android) which brings the parental control application
to phones, allowing to manage child users even when not at home.</p>
<h2 id="features-1"><a class="header" href="#features-1">Features</a></h2>
<h3 id="restrict-usage-hours"><a class="header" href="#restrict-usage-hours">Restrict usage hours</a></h3>
<p>This feature allows to restrict usage of the computer by the child user during
specific hours in the day. These hours can be set independently for each day of
the week, allowing for instance to set specific hours in the week-end. It's also
possible to set specific hours for some specific weeks or periods of times
(e.g. for four specific days in a row), allowing for instance to set specific hours
for vacations.</p>
<p>Child user will not be able to log in outside of these hours. If they are logged in
when the upper limit is reached (e.g. only 8AM to 9AM is allowed and the child user
is still logged in as 9AM), a warning message will shown 15 minutes before reaching
the time limit, 5 minutes before, and 1 minute before, allowing the child to save
its data.</p>
<p>When the final minute comes, a pop-up shows telling the session is going to be closed
in 60 seconds, and a cooldown is shown in a closable pop-up balloon in the taskbar.
An option is also shown to extend the session by up to fifteen-minutes, sending
a notification to the parent's phone as well as an e-mail.</p>
<p>The parent can then do nothing and the session will extend for a maximum of fifteen minutes,
or reject it and the computer will shut down after 1 minute. Then another option shows to
ask if the parent wants to permanently disable time extension.</p>
<h3 id="restrict-mature-contents"><a class="header" href="#restrict-mature-contents">Restrict mature contents</a></h3>
<p>The child user's birth date can be declared during setup, so its age (not its birth date)
will be availeble to every application which asks for it (with a specific permission, which
is by default automatically granted to all applications	which ask it).</p>
<p>This allows, for instance, for web browsers to block websites that declare themselves as showing
adult contents. Or even more precise protection, like a movies store not showing movies whom age
limit is beyond the child user's age.</p>
<h3 id="restrict-access-to-applications"><a class="header" href="#restrict-access-to-applications">Restrict access to applications</a></h3>
<p>This feature restricts access to some applications, either using a
whitelist (listing all the <em>allowed</em> applications) or using a blacklist
(listing all the <em>forbidden</em> applications).</p>
<p>It's possible to automatically white/black-list new applications.</p>
<h3 id="restrict-access-to-websites"><a class="header" href="#restrict-access-to-websites">Restrict access to websites</a></h3>
<p>This feature restricts access to some websites, either using a whitelist or
blacklist. It's also possible to apply these restrictions only to compatible
web browsers. Whitelist is strongly discouraged outside of web browsers-only
usage, as it may prevent some applicatiosns to work properly.</p>
<p>Whenever an application tries to access a forbidden website, the request will
fail with a specific code indicating it's forbidden by parental control. Applications
can still enforce this rule but this requires a specific permission that cannot be
allowed by child users.</p>
<p>These restrictions are enabled through the built-in firewall.</p>
<h3 id="restrict-installation-of-applications"><a class="header" href="#restrict-installation-of-applications">Restrict installation of applications</a></h3>
<p>This feature prevents child users from installing and running volatile applicaitons.
By default, installation is allowed but sends a notification to the parent user asking
if the child user is allowed to install the requested application; while running volatile
applications is simply disabled.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="user-experience"><a class="header" href="#user-experience">User Experience</a></h1>
<p>This folder contains technical documents about user experience.</p>
<ul>
<li><a href="ux/index.html#notifications">Notifications</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="notifications"><a class="header" href="#notifications">Notifications</a></h1>
<p><em>Notifications</em> are the way for both the applications and the system
itself to indicate when an event happens which user should be notified of,
or to indicate a persistent state.</p>
<ul>
<li><a href="ux/notifications.html#notifications">Notifications</a>
<ul>
<li><a href="ux/notifications.html#structure">Structure</a></li>
<li><a href="ux/notifications.html#display-rules">Display rules</a>
<ul>
<li><a href="ux/notifications.html#cover-image">Cover image</a></li>
<li><a href="ux/notifications.html#buttons">Buttons</a></li>
</ul>
</li>
<li><a href="ux/notifications.html#persistent-notifications">Persistent notifications</a></li>
<li><a href="ux/notifications.html#notification-types">Notification types</a>
<ul>
<li><a href="ux/notifications.html#free-notifications">Free Notifications</a></li>
<li><a href="ux/notifications.html#multimedia-notifications">Multimedia Notifications</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="structure"><a class="header" href="#structure">Structure</a></h2>
<p>A notification is made of:</p>
<ul>
<li>A title</li>
<li>A description</li>
</ul>
<p>As well as optional fields:</p>
<ul>
<li>A description</li>
<li>An icon (by default the icon of the <a href="ux/../concepts/applications.html">application</a>)</li>
<li>A notification sound (by default selected by the system)</li>
<li>A shaking effect</li>
<li>A background color (by default chosen by the desktop environment)</li>
<li>A set of <a href="ux/notifications.html#buttons">buttons</a></li>
<li>A <a href="ux/notifications.html#cover-image">cover image</a></li>
<li>A <a href="ux/notifications.html#persistent-notifications">persistent state</a></li>
<li>A <a href="ux/notifications.html#notification-types">type-dependent</a> set of data</li>
<li>A timeout</li>
<li>A handler called when the notification is clicked</li>
<li>A context menu when the notification is right-clicked</li>
</ul>
<h2 id="display-rules"><a class="header" href="#display-rules">Display rules</a></h2>
<p>The way notifications are displayed depends on the <a href="ux/">desktop environment (WIP)</a>,
therefore the requested shaking effect, background color, and so may not be respected
by DE, although it's highly recommended for DE to follow these attributes.</p>
<p>Also, there is no rule indicating how elements are visually arranged inside a notification.
Some DE may for instance put the icon on the left, while some others on the right. Additional
elements may also be displayed, such as a cross to close the notification or an arrow to hide
it to the <a href="ux/">notifications center (WIP)</a>.</p>
<h3 id="cover-image"><a class="header" href="#cover-image">Cover image</a></h3>
<p>A notification can request to display a large image. Some desktop environments may decide
to hide the application's icon in such case.</p>
<h3 id="buttons"><a class="header" href="#buttons">Buttons</a></h3>
<p>Notifications can have action buttons, which are then linked to the owner application's
event system. Buttons are usually limited in size and colors.</p>
<h2 id="persistent-notifications"><a class="header" href="#persistent-notifications">Persistent notifications</a></h2>
<p>Persistent notifications don't disappear after a timeout. They can for instance be used to
indicate a pending state like the activation of a battery-consuming element like a GPS.</p>
<h2 id="notification-types"><a class="header" href="#notification-types">Notification types</a></h2>
<p>There are several notification types, which their own required sets of data.</p>
<h3 id="free-notifications"><a class="header" href="#free-notifications">Free Notifications</a></h3>
<p>This is the default type of notifications, which no particular constraint.</p>
<h3 id="multimedia-notifications"><a class="header" href="#multimedia-notifications">Multimedia Notifications</a></h3>
<p>Multimedia notifications are used to indicate a <a href="ux/">multimedia playback (WIP)</a>. It must
be composed of a cover image and six buttons (previous, rewind, play/pause, stop, fast-forward, next)
whose appearance is decided by the <a href="ux/">desktop environment (WIP)</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="technical"><a class="header" href="#technical">Technical</a></h1>
<p>This folder contains technical documents which essential
describe low-level parts of LapisOS.</p>
<p>A global overview of the system can be found in
the <a href="technical/overview.html">overview document</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="overview"><a class="header" href="#overview">Overview</a></h1>
<p>This document presents a global overview of LapisOS. It is
only a simplified representation of the system, but allows
to better understand its architecture and organization.</p>
<p>The referenced documents are mostly technical overviews themselves, which
is why links to their associated specification document are also provided
(marked as <code>(specs)</code>)</p>
<ul>
<li><a href="technical/overview.html#overview">Overview</a>
<ul>
<li><a href="technical/overview.html#program-executions">Program executions</a></li>
<li><a href="technical/overview.html#permissions">Permissions</a></li>
<li><a href="technical/overview.html#hardware-access">Hardware access</a></li>
<li><a href="technical/overview.html#hardware-drivers">Hardware drivers</a></li>
<li><a href="technical/overview.html#hardware-access-performances">Hardware access performances</a></li>
<li><a href="technical/overview.html#filesystem-access">Filesystem access</a></li>
<li><a href="technical/overview.html#user-interface">User interface</a></li>
<li><a href="technical/overview.html#users-management">Users management</a></li>
</ul>
</li>
</ul>
<h2 id="program-executions"><a class="header" href="#program-executions">Program executions</a></h2>
<p>LapisOS doesn't allow to run standalone binaries. Every running code
is either:</p>
<ul>
<li>Part of the system, as the <a href="technical/">kernel (specs, WIP)</a> itself or as a
<a href="technical/">system service (WIP)</a> (<a href="technical/">specs (WIP)</a>).</li>
<li>Part of an <a href="technical/../concepts/applications.html">application</a> (<a href="technical/">specs (WIP)</a>).</li>
</ul>
<p>System services are immutable and run for the entire system's lifespan,
while applications can be opened and closed at anytime, and can also run
as multiple instances in parallel.</p>
<h2 id="permissions"><a class="header" href="#permissions">Permissions</a></h2>
<p>While the system has every right of the system itself, applications are
restricted and can do almost nothing by default.</p>
<p>Capabilities can be granted through <a href="technical/">permissions (WIP)</a> (<a href="technical/">specs (WIP)</a>),
which are designed to allow precise control on what an application can do or
not, while requiring as few user interactions as possible.</p>
<h2 id="hardware-access"><a class="header" href="#hardware-access">Hardware access</a></h2>
<p>Hardware access is performed through two layers:</p>
<ul>
<li>First, the kernel <a href="technical/">detects and enumerates (specs, WIP)</a> hardware devices</li>
<li>Then, hardware is accessed through the <a href="technical/">hardware service (specs, WIP)</a></li>
</ul>
<h2 id="hardware-drivers"><a class="header" href="#hardware-drivers">Hardware drivers</a></h2>
<p>Unlike most operating systems, hardware drivers are simple applications with
no specific integration in the kernel.</p>
<p>Any application register itself as a <a href="technical/">driver (specs, WIP)</a> using the
<a href="technical/">hardware service (specs, WIP)</a>.</p>
<p>The relevant driver for each hardware device is selected using
<a href="technical/">various criterias (specs)</a>.</p>
<h2 id="hardware-access-performances"><a class="header" href="#hardware-access-performances">Hardware access performances</a></h2>
<p>Hardware access is performed through <a href="technical/">syscalls (specs, WIP)</a> and
<a href="technical/">signals (specs, WIP)</a>, which use CPU interruptions.</p>
<p>The access process is often:</p>
<ul>
<li>A userland process notifies a <a href="technical/">system service (WIP)</a></li>
<li>The system service contacts the [hardware service (specs, WIP)]</li>
<li>The hardware service contacts the <a href="technical/">relevant (specs, WIP)</a> <a href="technical/">driver (specs, WIP)</a></li>
<li>The driver performs the requested task by communicating with the hardware through the hardware service</li>
<li>The action's result is then transmitted to the hardware service, which then transmits it to the system service, which in turns transmits it to the userland process</li>
</ul>
<h2 id="filesystem-access"><a class="header" href="#filesystem-access">Filesystem access</a></h2>
<p>Accessing and managing filesystems and their contents is faster than common hardware
operations thanks to <a href="technical/">direct storage access (WIP)</a>.</p>
<p>The typical process involves communication with the <a href="technical/">filesystem service (WIP)</a>
which <a href="technical/">communicates directly (WIP)</a> with storage files.</p>
<p>For filesystems that <a href="technical/">aren't natively supported (WIP)</a>, a <a href="technical/">filesystem interface (WIP)</a>
is involved to communicate with the <a href="technical/">storage driver service (WIP)</a>, which then communicates
with the <a href="technical/">hardware service (WIP)</a>. This involves a higher latency, but is only limited to
edge cases and remains in an acceptable range of performances.</p>
<h2 id="user-interface"><a class="header" href="#user-interface">User interface</a></h2>
<p>The user interface is entirely managed by <a href="technical/">desktop environment (WIP)</a>, which can be
any <a href="technical/../concepts/applications.html">application</a> exposing the <a href="technical/">relevant service (specs, WIP)</a>.</p>
<h2 id="users-management"><a class="header" href="#users-management">Users management</a></h2>
<p>Each person using a computer can have its own <a href="technical/../concepts/users.html">user account</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="controller"><a class="header" href="#controller">Controller</a></h1>
<p><em>Controller</em> is a system library that manages permissions of libraries.</p>
<p>It is concretely represented by the <a href="technical/"><code>sys::perm</code> (WIP)</a> service.</p>
<ul>
<li><a href="technical/controller.html#controller">Controller</a>
<ul>
<li><a href="technical/controller.html#notion-of-scope">Notion of scope</a></li>
<li><a href="technical/controller.html#the-perm-system-library">The perm system library</a></li>
<li><a href="technical/controller.html#permission-extension">Permission extension</a></li>
</ul>
</li>
</ul>
<h2 id="notion-of-scope"><a class="header" href="#notion-of-scope">Notion of scope</a></h2>
<p>Permissions are split into several scopes:</p>
<ul>
<li>The <em>application scope</em> contains the permissions a given process is borned from</li>
<li>The <em>user scope</em> contains the permissions the user who launched the application has</li>
<li>The <em>mode scope</em> contains the permissions the <em>execution mode</em> (either system or userland) has</li>
</ul>
<p>The mode scope restricts the user scope, which itself restricts the application scope.
This means that, if the application scope specify a permission that is not covered by
the user scope, it is not applyable to the process. This allows to prevent applications
and users from getting too high permissions.</p>
<p>The mode scope prevents applications from performing harmful tasks such as writing the
system. Only system applications, which run in system mode instead of userland mode,
gets an unrestricted mode scope.</p>
<h2 id="the-perm-system-library"><a class="header" href="#the-perm-system-library">The perm system library</a></h2>
<p>The <code>perm</code> system library is an interface for the controller which allows processes
to check their own permissions, ensure they can make I/O requests before effectively
making them, and extend their permissions.</p>
<h2 id="permission-extension"><a class="header" href="#permission-extension">Permission extension</a></h2>
<p>A process can, at any moment, send a <em>permission extension request</em> (PER) using
the <code>perm</code> library. It allows to gain a new permission by showing an overlay the
user can accept or decline. If the permission is accepted, the requested permission
is added to the process' one - and sometimes the application's one.</p>
<p>If the requested permission is out of its maximum scope (e.g. asking for write access to
<code>/etc</code> while being ran as standard user), the request is automatically rejected.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="developer-mode"><a class="header" href="#developer-mode">Developer Mode</a></h1>
<p>The <em>developer mode</em> enables several features that are not available by default.
Only administrator user get access to them when they are enabled.</p>
<ul>
<li><a href="technical/dev-mode.html#developer-mode">Developer Mode</a>
<ul>
<li><a href="technical/dev-mode.html#how-to-enable">How to enable</a></li>
<li><a href="technical/dev-mode.html#application-proxies">Application proxies</a></li>
</ul>
</li>
</ul>
<h2 id="how-to-enable"><a class="header" href="#how-to-enable">How to enable</a></h2>
<p>Developer mode can be enabled either by typing the following command in the terminal:</p>
<pre><code>adm central --enable dev-mode
</code></pre>
<p>Or, while holding the <code>Ctrl</code> <code>Alt</code> and <code>Maj</code> key, type <code>DEV</code>.</p>
<p>A warning dialog will appear. If you confirm, it will display an
<a href="technical/../concepts/users.html#user-privileges-elevation-upe">UPE dialog</a>
for the administrator account. Then a final confirmation dialog
will ensure you're sure about what you're doing. Then development mode will
be enabled (no reboot is required).</p>
<h2 id="application-proxies"><a class="header" href="#application-proxies">Application proxies</a></h2>
<p><em>Application proxies</em> are applications that intercept all applications calls to
the system on-the-fly. It is useful for applications debugging.</p>
<p>When a proxy is set up for an application, all system calls sent to this application
will be transferred to the proxy, which will be able to do whatever it wants with it.
It's possible for the proxy to never answer the signal, to change its content before
actually sending it to the system, etc.</p>
<p>Basic usage of an application proxy is as a &quot;listener&quot;: it only listens to specific
signals and logs them, without cancelling them and/or modifying them. This is useful
to check all filesystem access requested by an application, in real time.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="devices"><a class="header" href="#devices">Devices</a></h1>
<ul>
<li><a href="technical/devices.html#devices">Devices</a>
<ul>
<li><a href="technical/devices.html#connecting-a-new-device">Connecting a new device</a></li>
<li><a href="technical/devices.html#interacting-with-a-device">Interacting with a device</a></li>
<li><a href="technical/devices.html#device-handler-files-persistence">Device handler files persistence</a></li>
<li><a href="technical/devices.html#custom-device-handler-filename">Custom device handler filename</a></li>
</ul>
</li>
</ul>
<h2 id="connecting-a-new-device"><a class="header" href="#connecting-a-new-device">Connecting a new device</a></h2>
<p>When a device is connected to the compiter, a <em>device handler file</em> (DHF) is
created in the <code>/dev</code> directory.</p>
<p>Depending on its type, it will be put in a different directory.</p>
<p>The filename itself is a random unique identifier made of a single
lowercase letter, a digit, another lowercase letter and finally
another digit.</p>
<p>For instance, if a hard drive is connected to the computer, the DHF may be
something like <code>/dev/sst/m2p1</code>.</p>
<h2 id="interacting-with-a-device"><a class="header" href="#interacting-with-a-device">Interacting with a device</a></h2>
<p>Device handler files are not simple files, they can only be used through the <a href="technical/"><code>sys::hw</code> (WIP)</a> service.</p>
<p>Different actions may be happen depending on the device's type:</p>
<ul>
<li><strong>Camera devices:</strong> when an application asks to capture a photo/video, the device will be suggested to take the images from</li>
<li><strong>Microphones:</strong> when an application asks to capture sound, the device will be suggested to capture the sound from</li>
<li><strong>Sound output devices:</strong> the device will be available for playback</li>
<li><strong>Network adapters:</strong> the device will be available to make network requests on</li>
<li><strong>Other supported wireless devices:</strong> depends on the type (Bluetooth adapter, ...)</li>
<li><strong>Basic/persistent storage devices:</strong> when possible, the device will be automatically mounted in <code>/mnt</code> and visible in the files explorer</li>
</ul>
<p>For uncategorized devices (in <code>/dev/etc</code>), a popup is shown to the user, to indicate the connected device is not
recognized. Some applications may still be able to interact with it (for instance, a storage device using an
unsupported protocol).</p>
<h2 id="device-handler-files-persistence"><a class="header" href="#device-handler-files-persistence">Device handler files persistence</a></h2>
<p>When a device is disconnected, its DHF is not removed. Instad, if a process tries to interact with the DHF, the
<a href="technical/"><code>sys::hw</code> (WIP)</a> service will indicate the device is currently not connected.</p>
<p>When the device is connected again, it is associated to the same DHF again. This allows applications to persist
the device's location and use it later on.</p>
<h2 id="custom-device-handler-filename"><a class="header" href="#custom-device-handler-filename">Custom device handler filename</a></h2>
<p>It's possible to give a custom handler filename or intuitivity. In such case, a new DHF is created in the related
directory, but the old DHF is kept anyway. This allows to not break compatibility with applications that rely
on the old DHF.</p>
<p>The two DHF will point to the exact same device, without and difference. The custom DHF can be removed anytime,
although this is discouraged as applications may rely on it.</p>
<p>Also, custom DHF names must always be longer than 4 characters, to avoid confusion with automatically-generated DHFs.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="specifications"><a class="header" href="#specifications">Specifications</a></h1>
<p>This folder contains <em>specification documents</em>, whose purpose is to
describe fully a specific concept or feature. For more informations
about low-level concepts these documents refer to, you can check
<a href="specs/../technical/README.html">technical documents</a> first.</p>
<ul>
<li><a href="specs/applications-and-libraries.html">Applications and libraries</a> - document describing
common things between applications and libraries</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="applications-and-libraries"><a class="header" href="#applications-and-libraries">Applications and Libraries</a></h1>
<p>This document describes the structure, features and behaviours to both
<a href="specs/../concepts/applications.html">applications</a> and <a href="specs/../concepts/libraries.html">libraries</a>.</p>
<ul>
<li><a href="specs/applications-and-libraries.html#applications-and-libraries">Applications and Libraries</a>
<ul>
<li><a href="specs/applications-and-libraries.html#name-and-slug">Name and slug</a></li>
<li><a href="specs/applications-and-libraries.html#application-identifier">Application Identifier</a></li>
<li><a href="specs/applications-and-libraries.html#features">Features</a></li>
<li><a href="specs/applications-and-libraries.html#the-manifest">The manifest</a></li>
</ul>
</li>
</ul>
<h2 id="name-and-slug"><a class="header" href="#name-and-slug">Name and slug</a></h2>
<p>Each application has a name as well as a slug. The name can any valid UTF-8 string,
while the slug must respect several rules:</p>
<ul>
<li>Only lowercase letters, underscores and digits</li>
<li>Must not start by a digit</li>
<li>Must not be the name of a native shell command</li>
<li>Must not be the name of a native shell function</li>
<li>Must not be the name of a shell type</li>
</ul>
<p>By default, the slug is auto-generated from the name, but it can also be customized.</p>
<h2 id="application-identifier"><a class="header" href="#application-identifier">Application Identifier</a></h2>
<p>From the slug is generated <em>Application's Identifier (AID)</em>, which is prefixed by the
developer's identifier (DID) specified in the application's manifest (it must match the
publisher's identifier on the store), and followed by two double points. The DID is submitted
to the same rules as the application's slug.</p>
<p>For instance, an application with a slug of <code>midori</code> made by a developer whose DID is
<code>gulje</code> will get an AID of <code>midori::gulje</code>.</p>
<p>The AID is unique across the store as well as in a single LapisOS installation. As malicious
application may provide the DID and the slug of a legit application (which is called <em>AID spoofing</em>),
sideloading is <a href="specs/../concepts/applications.html#sideloading">verified by default</a>.</p>
<p>As AID are text-based and can be quite long (up to 512 bytes), programs can instead use the
<em>Application's Numeric IDentifier (ANID)</em>, which is 32-bit unique number randomly generated
by the system to refer to this particular application. On two different systems, the ANID of
a given application will likely be very different, and so cannot be guessed. It is provided
by the system during the application's launch through its <a href="specs/">execution context (WIP)</a>.</p>
<p>System applications are registered under the reserved <code>sys</code> DID.</p>
<h2 id="features-2"><a class="header" href="#features-2">Features</a></h2>
<p>Applications as well as libraries can also declare <em>features</em>, which are opt-in parts of
the program. They are described in <a href="specs/">the manifest (WIP)</a> and can be enabled or disabled
when installing a program.</p>
<p>Each feature allows to embed additional assets and declare additional supported languages
(e.g. language packs), and a specific build option is provided to the build tool to indicate
at build time weither a feature selected or not.</p>
<p>This allows to save space and build time when a specific feature isn't required, but should
still be embedded in the program itself instead of making an additional application or
library.</p>
<p>When the manifest declares one or more feature(s), it must also specify a set of <em>default features</em>
to enable, which are selected by default.</p>
<h2 id="the-manifest"><a class="header" href="#the-manifest">The manifest</a></h2>
<p>A <em>manifest</em> is a file describing the application or library. It is mandatory to build and
distribute it. Its content differ for applications and libraries, but there are some
common fields.</p>
<pre><code class="language-yaml"># [REQ] Informations about the application
infos:
	# [REQ] Application's name, as shown when installing it
	name: Cloud Notepad App
	# [REQ] Application's slug, as stored on the disk in the /apps directory
	slug: cloud-notepad-app
	# [REQ] Application's description, as shown when installing it
	description: A notepad application that allows syncing your files in the cloud
	# [REQ] Application's version, following semantic versioning
	version: 1.0.0
	# [REQ] Application's author(s)
	authors:
		- name: Gulce
		- email: guljeee@yandex.com
	# [REQ] Application's icons
	# [REQ] &quot;%{}&quot;: either 16, 32, 64, 128 or 256 pixels (icons must be square)
	icons: assets/icons/app/%{}.png
	# [REQ] Application's license
	license: Apache-2.0

# [REQ] Application package's content
content:
	# [REQ] Program
	program:
		# Packages can either contain source code only, pre-compiled programs only, or both
		# &lt;for source packages&gt; [REQ]
		source:
			# [REQ] Build tool (must in the list of the toolchain's supported build tools)
			toolchain: rust
			# [REQ] Required build tool-related options
			build: {}
			# [OPT] Build tool-related options
			options:
				optimize: O3

		# &lt;for precomp packages&gt; [REQ]
		precomp: main.lpp

	# [OPT] Assets
	assets:
		# Set of path to assets
		- ./assets/

# [REQ] Application's dependencies
dependencies:
	# [REQ] Required libraries
	libraries:
		sysver: ^1.0.0 # Any stable version

	# [OPT] Required fonts
	fonts:
		fonts:open-sans: true # Any version

# [OPT] Features
features:
	# Describe each feature, by name
	testing:
		# [OPT] Additional assets
		assets: []

		# [OPT] Feature's dependencies
		dependencies: {}

		# [OPT] Additional languages (e.g. language pack)
		languages: []
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
